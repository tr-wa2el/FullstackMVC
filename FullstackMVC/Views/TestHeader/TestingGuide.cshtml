@{
    ViewData["Title"] = "Filter Testing Guide";
}

<div class="container mt-5">
 <div class="row">
  <div class="col-12">
       <div class="card shadow-lg">
                <div class="card-header bg-gradient" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
     <h2><i class="bi bi-clipboard-check"></i> How to Test Result Filters</h2>
  <p class="mb-0">Complete guide to seeing filters in action</p>
           </div>
   <div class="card-body">

     <!-- Quick Start -->
     <div class="alert alert-success">
      <h4><i class="bi bi-rocket"></i> Quick Start</h4>
    <ol class="mb-0">
    <li>Open Browser Developer Tools (<kbd>F12</kbd>)</li>
     <li>Go to <strong>Network</strong> tab</li>
      <li>Click any test button below</li>
      <li>Click on the request in Network tab</li>
  <li>View <strong>Response Headers</strong> section</li>
 </ol>
    </div>

  <!-- Method 1: Browser DevTools -->
      <div class="card mb-4">
   <div class="card-header bg-primary text-white">
    <h4><i class="bi bi-browser-chrome"></i> Method 1: Browser Developer Tools (Recommended)</h4>
 </div>
   <div class="card-body">
   <div class="row">
       <div class="col-md-6">
    <h5>Chrome / Edge / Opera</h5>
       <div class="list-group">
   <div class="list-group-item">
  <span class="badge bg-primary">1</span> Press <kbd>F12</kbd> or <kbd>Ctrl+Shift+I</kbd>
        </div>
        <div class="list-group-item">
      <span class="badge bg-primary">2</span> Click <strong>Network</strong> tab
                 </div>
    <div class="list-group-item">
 <span class="badge bg-primary">3</span> Reload page (<kbd>F5</kbd>) or navigate
     </div>
            <div class="list-group-item">
      <span class="badge bg-primary">4</span> Click on any request (e.g., "ViewHeaders")
   </div>
        <div class="list-group-item">
    <span class="badge bg-primary">5</span> Click <strong>Headers</strong> tab
    </div>
             <div class="list-group-item">
       <span class="badge bg-primary">6</span> Scroll to <strong>Response Headers</strong>
           </div>
       </div>
  </div>
     <div class="col-md-6">
     <h5>Firefox</h5>
         <div class="list-group">
   <div class="list-group-item">
  <span class="badge bg-danger">1</span> Press <kbd>F12</kbd> or <kbd>Ctrl+Shift+K</kbd>
         </div>
      <div class="list-group-item">
    <span class="badge bg-danger">2</span> Click <strong>Network</strong> tab
      </div>
               <div class="list-group-item">
    <span class="badge bg-danger">3</span> Reload page or navigate
</div>
      <div class="list-group-item">
    <span class="badge bg-danger">4</span> Click on the request
            </div>
           <div class="list-group-item">
      <span class="badge bg-danger">5</span> Click <strong>Headers</strong> section
  </div>
          <div class="list-group-item">
 <span class="badge bg-danger">6</span> View <strong>Response Headers</strong>
        </div>
        </div>
            </div>
 </div>

     <div class="mt-3">
    <img src="https://via.placeholder.com/800x400/f8f9fa/6c757d?text=Open+Network+Tab+%3E+Click+Request+%3E+View+Headers" 
       class="img-fluid border rounded" alt="DevTools Network Tab">
    </div>

     <div class="alert alert-info mt-3">
       <strong><i class="bi bi-lightbulb"></i> Pro Tip:</strong> 
         Look for headers starting with <code>X-</code> - these are custom headers added by filters!
       </div>
    </div>
      </div>

        <!-- Method 2: Interactive Buttons -->
    <div class="card mb-4">
      <div class="card-header bg-success text-white">
     <h4><i class="bi bi-cursor"></i> Method 2: Interactive Testing (Easiest)</h4>
     </div>
       <div class="card-body">
      <p>Click the buttons below and watch the results appear in real-time:</p>
  
         <div class="row g-3">
     <div class="col-md-4">
        <div class="card border-primary">
   <div class="card-body">
   <h6>No Filter</h6>
      <p class="small text-muted">Standard headers only</p>
          <a href="@Url.Action("WithoutHeader")" class="btn btn-outline-primary w-100">
        <i class="bi bi-x-circle"></i> Test
       </a>
   </div>
           </div>
        </div>
    <div class="col-md-4">
     <div class="card border-success">
        <div class="card-body">
         <h6>With Filter</h6>
        <p class="small text-muted">Custom headers added</p>
       <a href="@Url.Action("ViewHeaders")" class="btn btn-outline-success w-100">
            <i class="bi bi-check-circle"></i> Test
            </a>
     </div>
       </div>
               </div>
  <div class="col-md-4">
      <div class="card border-warning">
 <div class="card-body">
       <h6>With Caching</h6>
  <p class="small text-muted">Cached for 2 minutes</p>
   <a href="@Url.Action("WithCaching")" class="btn btn-outline-warning w-100">
     <i class="bi bi-hourglass"></i> Test
     </a>
  </div>
        </div>
       </div>
           </div>

 <div class="alert alert-warning mt-3">
  <strong><i class="bi bi-info-circle"></i> Remember:</strong> 
         Keep Network tab open before clicking these buttons to see the headers!
       </div>
     </div>
        </div>

  <!-- Method 3: Command Line -->
          <div class="card mb-4">
     <div class="card-header bg-dark text-white">
      <h4><i class="bi bi-terminal"></i> Method 3: Command Line Testing</h4>
    </div>
  <div class="card-body">
    
       <h5><i class="bi bi-windows"></i> PowerShell</h5>
     <div class="bg-dark text-light p-3 rounded mb-3">
       <code>
     # Simple header view<br>
     Invoke-WebRequest "@(Context.Request.Scheme)://@(Context.Request.Host)@Url.Action("ViewHeaders")" | Select-Object -ExpandProperty Headers<br>
  <br>
     # Detailed view<br>
        $response = Invoke-WebRequest "@(Context.Request.Scheme)://@(Context.Request.Host)@Url.Action("ViewHeaders")"<br>
         $response.Headers | Format-Table -AutoSize
       </code>
   </div>

  <h5><i class="bi bi-terminal"></i> cURL (Git Bash / Linux / Mac)</h5>
      <div class="bg-dark text-light p-3 rounded mb-3">
    <code>
 # Headers only<br>
  curl -I @(Context.Request.Scheme)://@(Context.Request.Host)@Url.Action("ViewHeaders")<br>
          <br>
  # Verbose output<br>
    curl -v @(Context.Request.Scheme)://@(Context.Request.Host)@Url.Action("ViewHeaders")
          </code>
   </div>

         <div class="alert alert-info">
          <strong><i class="bi bi-info-circle"></i> Note:</strong> 
 Look for lines starting with <code>&lt;</code> in cURL output - these are response headers.
    </div>
     </div>
           </div>

   <!-- Method 4: Application Logs -->
         <div class="card mb-4">
    <div class="card-header bg-info text-white">
     <h4><i class="bi bi-file-text"></i> Method 4: Check Application Logs</h4>
           </div>
        <div class="card-body">
 <p>Result filters log their activity. Check these locations:</p>
          
          <div class="row">
        <div class="col-md-6">
 <div class="card bg-light">
        <div class="card-body">
  <h6><i class="bi bi-terminal"></i> Visual Studio Output</h6>
    <ol>
        <li>Run the application (<kbd>F5</kbd>)</li>
   <li>Open <strong>View → Output</strong></li>
        <li>Select "Debug" or "Web Server" from dropdown</li>
           <li>Navigate to a page with filters</li>
    <li>See log messages appear</li>
       </ol>
    </div>
          </div>
       </div>
        <div class="col-md-6">
        <div class="card bg-light">
     <div class="card-body">
   <h6><i class="bi bi-journal-code"></i> Console Window</h6>
      <ol>
        <li>Run app with <code>dotnet run</code></li>
            <li>Watch console output</li>
     <li>Navigate to filtered pages</li>
       <li>See real-time log messages</li>
           <li>Look for "Result filter:" entries</li>
       </ol>
       </div>
       </div>
      </div>
      </div>

             <div class="mt-3">
  <h6>Example Log Output:</h6>
      <div class="bg-dark text-light p-3 rounded">
    <code style="color: #00ff00;">
       info: FullstackMVC.Filters.AddCustomHeaderFilter[0]<br>
 <span style="color: #00ffff;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Result filter: Added header 'X-Demo-Header' = 'DemoValue'</span><br>
        info: FullstackMVC.Filters.AddCustomHeaderFilter[0]<br>
    <span style="color: #00ffff;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Executing result for action: TestHeaderController.ViewHeaders</span><br>
       info: FullstackMVC.Filters.AddCustomHeaderFilter[0]<br>
       <span style="color: #00ffff;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Result executed for action: TestHeaderController.ViewHeaders</span>
      </code>
       </div>
     </div>
       </div>
        </div>

      <!-- What to Look For -->
       <div class="card mb-4">
    <div class="card-header bg-warning">
  <h4><i class="bi bi-search"></i> What to Look For</h4>
       </div>
    <div class="card-body">
   <div class="table-responsive">
           <table class="table table-striped">
       <thead>
       <tr>
   <th>Header Name</th>
    <th>Example Value</th>
        <th>Source</th>
        <th>Description</th>
         </tr>
     </thead>
     <tbody>
      <tr class="table-primary">
     <td><code>X-Demo-Header</code></td>
<td><code>DemoValue</code></td>
    <td><span class="badge bg-primary">AddCustomHeaderFilter</span></td>
      <td>Custom header from Result Filter</td>
        </tr>
         <tr class="table-primary">
       <td><code>X-Response-Time</code></td>
    <td><code>2024-01-15 10:30:45</code></td>
        <td><span class="badge bg-primary">AddCustomHeaderFilter</span></td>
    <td>UTC timestamp when response was generated</td>
       </tr>
       <tr class="table-info">
         <td><code>X-Controller-Name</code></td>
     <td><code>TestHeaderController</code></td>
   <td><span class="badge bg-info">Manual</span></td>
       <td>Added manually in action method</td>
         </tr>
     <tr class="table-warning">
      <td><code>Cache-Control</code></td>
    <td><code>public, max-age=120</code></td>
      <td><span class="badge bg-warning">CacheResultFilter</span></td>
   <td>Browser caching instructions</td>
   </tr>
   <tr class="table-warning">
       <td><code>Expires</code></td>
      <td><code>Mon, 15 Jan 2024...</code></td>
 <td><span class="badge bg-warning">CacheResultFilter</span></td>
       <td>Expiration time for cached content</td>
 </tr>
       <tr>
        <td><code>Content-Type</code></td>
       <td><code>text/html; charset=utf-8</code></td>
     <td><span class="badge bg-secondary">Standard</span></td>
       <td>Standard ASP.NET header</td>
     </tr>
      </tbody>
       </table>
    </div>

     <div class="alert alert-success">
        <strong><i class="bi bi-check-circle"></i> Success Indicators:</strong>
       <ul class="mb-0">
        <li>Headers starting with <code>X-</code> indicate custom filters are working</li>
   <li><code>Cache-Control</code> header shows caching filter is active</li>
    <li>Log messages in console confirm filter execution</li>
         </ul>
   </div>
     </div>
       </div>

       <!-- Quick Tests -->
       <div class="card mb-4">
      <div class="card-header" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white;">
   <h4><i class="bi bi-lightning"></i> Quick Tests</h4>
   </div>
         <div class="card-body">
     <div class="list-group">
    <a href="@Url.Action("CompareFilters")" class="list-group-item list-group-item-action">
       <div class="d-flex w-100 justify-content-between">
  <h5 class="mb-1"><i class="bi bi-funnel-fill"></i> Compare Filters Side-by-Side</h5>
      <span class="badge bg-primary">Interactive</span>
   </div>
      <p class="mb-1">See the difference filters make with live comparison</p>
       </a>
    <a href="@Url.Action("ViewHeaders")" class="list-group-item list-group-item-action">
     <div class="d-flex w-100 justify-content-between">
       <h5 class="mb-1"><i class="bi bi-list-check"></i> View All Headers</h5>
     <span class="badge bg-success">Detailed</span>
         </div>
   <p class="mb-1">Complete header viewer with JavaScript fetch</p>
       </a>
     <a href="@Url.Action("WithCaching")" class="list-group-item list-group-item-action">
    <div class="d-flex w-100 justify-content-between">
       <h5 class="mb-1"><i class="bi bi-hourglass-split"></i> Test Caching</h5>
         <span class="badge bg-warning">Cached</span>
       </div>
       <p class="mb-1">See how Cache-Control headers work</p>
            </a>
         <a href="@Url.Action("WithMultipleHeaders")" class="list-group-item list-group-item-action">
 <div class="d-flex w-100 justify-content-between">
    <h5 class="mb-1"><i class="bi bi-stack"></i> Multiple Filters</h5>
   <span class="badge bg-info">Advanced</span>
  </div>
 <p class="mb-1">Test multiple filters applied to same action</p>
            </a>
    </div>
     </div>
    </div>

      <!-- Troubleshooting -->
   <div class="card mb-4">
   <div class="card-header bg-danger text-white">
   <h4><i class="bi bi-exclamation-triangle"></i> Troubleshooting</h4>
        </div>
      <div class="card-body">
       <dl>
      <dt>❌ Headers not appearing?</dt>
   <dd>
   <ul>
        <li>Make sure Network tab was open BEFORE navigating</li>
      <li>Check "Preserve log" is enabled in DevTools</li>
    <li>Clear browser cache and try again</li>
   <li>Verify filter attribute is on the action/controller</li>
      </ul>
    </dd>

  <dt>❌ Logs not showing?</dt>
   <dd>
       <ul>
 <li>Check log level in appsettings.json (should be "Information" or "Debug")</li>
     <li>Make sure you're looking at the right output source</li>
       <li>Try running with <code>dotnet run</code> to see console output</li>
         </ul>
     </dd>

     <dt>❌ Caching not working?</dt>
    <dd>
      <ul>
     <li>Check for <code>Cache-Control</code> header in response</li>
       <li>Try in incognito/private window</li>
        <li>Some browsers ignore cache for localhost</li>
     <li>Clear browser cache (Ctrl+Shift+Delete)</li>
  </ul>
      </dd>
       </dl>
    </div>
</div>

     <!-- Navigation -->
       <div class="d-grid gap-2 d-md-flex justify-content-md-center">
    <a asp-action="CompareFilters" class="btn btn-primary btn-lg">
    <i class="bi bi-funnel"></i> Start Testing Filters
     </a>
    <a asp-action="ViewHeaders" class="btn btn-success btn-lg">
       <i class="bi bi-list-check"></i> View Headers
     </a>
    <a asp-controller="Home" asp-action="Index" class="btn btn-secondary btn-lg">
         <i class="bi bi-house"></i> Home
      </a>
         </div>

     </div>
        </div>
  </div>
    </div>
</div>
