@model IEnumerable<FullstackMVC.Models.Department>

@{
    ViewData["Title"] = "Manage Departments";
}

<div class="container-fluid mt-4">
  <div class="row">
      <div class="col-12">
  <div class="card shadow">
       <div class="card-header bg-dark text-white d-flex justify-content-between align-items-center">
       <h2 class="mb-0">
 <i class="bi bi-building-fill"></i> Department Management
     </h2>
     <a asp-action="CreateDepartment" class="btn btn-info">
      <i class="bi bi-plus-circle"></i> Add New Department
  </a>
  </div>
      <div class="card-body">
      @if (Model != null && Model.Any())
      {
    <!-- Department Statistics -->
   <div class="row g-4 mb-4">
      <div class="col-md-3">
     <div class="card bg-info text-white">
       <div class="card-body text-center">
       <h3>@Model.Count()</h3>
    <p class="mb-0">Total Departments</p>
        </div>
       </div>
      </div>
    <div class="col-md-3">
      <div class="card bg-primary text-white">
     <div class="card-body text-center">
      <h3>@Model.Sum(d => d.Students?.Count ?? 0)</h3>
       <p class="mb-0">Total Students</p>
    </div>
      </div>
     </div>
     <div class="col-md-3">
      <div class="card bg-success text-white">
     <div class="card-body text-center">
       <h3>@Model.Sum(d => d.Courses?.Count ?? 0)</h3>
  <p class="mb-0">Total Courses</p>
    </div>
     </div>
      </div>
    <div class="col-md-3">
     <div class="card bg-warning text-dark">
   <div class="card-body text-center">
<h3>@Model.Sum(d => d.PcNumbers)</h3>
   <p class="mb-0">Total PCs</p>
    </div>
</div>
     </div>
      </div>

      <!-- Departments Table -->
     <div class="table-responsive">
   <table class="table table-striped table-hover">
     <thead class="table-dark">
    <tr>
     <th>ID</th>
     <th>Department Name</th>
  <th>Manager</th>
     <th>Location</th>
      <th>PC Numbers</th>
     <th>Students</th>
      <th>Courses</th>
     <th>Actions</th>
     </tr>
     </thead>
      <tbody>
    @foreach (var department in Model.OrderBy(d => d.Name))
   {
      var studentsCount = department.Students?.Count ?? 0;
       var coursesCount = department.Courses?.Count ?? 0;
      
       <tr>
   <td><strong class="text-primary">@department.Id</strong></td>
     <td>@department.Name</td>
  <td>@department.ManagerName</td>
  <td>@department.Location</td>
    <td>
     <span class="badge bg-warning text-dark">@department.PcNumbers PCs</span>
    </td>
   <td>
    <span class="badge bg-primary">@studentsCount</span>
     @if (studentsCount > 0)
      {
      <br><small class="text-muted">students</small>
 }
    </td>
      <td>
    <span class="badge bg-success">@coursesCount</span>
      @if (coursesCount > 0)
    {
    <br><small class="text-muted">courses</small>
    }
   </td>
      <td>
     <div class="btn-group" role="group">
       <a asp-action="EditDepartment" asp-route-id="@department.Id" 
 class="btn btn-sm btn-warning" title="Edit">
     <i class="bi bi-pencil"></i>
      </a>
       <a asp-action="DeleteDepartment" asp-route-id="@department.Id" 
      class="btn btn-sm btn-danger" title="Delete"
    onclick="return confirm('Are you sure you want to delete this department?');">
    <i class="bi bi-trash"></i>
    </a>
     <a asp-action="DepartmentDetails" asp-route-id="@department.Id" 
    class="btn btn-sm btn-info" title="Details">
       <i class="bi bi-eye"></i>
      </a>
      </div>
 </td>
       </tr>
     }
    </tbody>
      </table>
    </div>
 }
     else
      {
    <div class="text-center py-5">
       <i class="bi bi-building text-muted" style="font-size: 4rem;"></i>
    <h4 class="text-muted mt-3">No Departments Found</h4>
      <p class="text-muted">Click "Add New Department" to create your first department.</p>
      </div>
    }
      </div>
   </div>
 </div>
    </div>
</div>